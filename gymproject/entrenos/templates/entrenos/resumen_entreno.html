<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Resumen de Entrenamiento</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
          background-color: #0f0f0f;
          color: white;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
          padding: 20px;
          margin: 0;
        }

        .container {
          max-width: 800px;
          margin: 0 auto;
        }

        h1 {
          font-size: 28px;
          font-weight: bold;
          margin-bottom: 20px;
          color: white;
        }

        .grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 12px;
        }

        .card {
          background-color: #1a1a1a;
          border-radius: 12px;
          padding: 16px;
          border: 1px solid #333;
        }

        .card-title {
          font-size: 18px;
          font-weight: 600;
          margin-bottom: 10px;
          display: flex;
          align-items: center;
          gap: 6px;
        }

        .green-text {
          color: #32FF00;
        }

        .red-text {
          color: #ff4d4d;
        }

        .yellow-text {
          color: #FFD700;
        }

        .cyan-text {
          color: #00FFFF;
        }

        .pink-text {
          color: #FF69B4;
        }

        .full-width {
          grid-column: span 2;
        }

        .checkmark {
          display: inline-block;
          width: 20px;
          height: 20px;
          background-color: #32FF00;
          border-radius: 50%;
        }

        .circle-empty {
          display: inline-block;
          width: 20px;
          height: 20px;
          background-color: #333;
          border-radius: 50%;
        }

        .consistency-circles {
          display: flex;
          gap: 4px;
          margin: 10px 0;
        }

        .btn {
          background-color: #0066ff;
          color: white;
          border: none;
          border-radius: 10px;
          padding: 12px;
          font-weight: 600;
          width: 100%;
          margin-top: 10px;
          cursor: pointer;
        }

        .progress-chart {
          width: 100%;
          height: 150px;
        }

        .progress-img {
          max-width: 60px;
          border-radius: 5px;
          float: right;
        }

        .arrow-up {
          color: #32FF00;
        }

        .arrow-down {
          color: #ff4d4d;
        }
		/* A√±adir al CSS */
.notificaciones-opciones {
  display: flex;
  align-items: center;
  margin-top: 10px;
  font-size: 14px;
}

.switch {
  position: relative;
  display: inline-block;
  width: 40px;
  height: 20px;
  margin-right: 10px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #333;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 16px;
  width: 16px;
  left: 2px;
  bottom: 2px;
  background-color: white;
  transition: .4s;
}

input:checked + .slider {
  background-color: #32FF00;
}

input:checked + .slider:before {
  transform: translateX(20px);
}

.slider.round {
  border-radius: 20px;
}
/* A√±adir al CSS */
.tabs {
  display: flex;
  margin-bottom: 15px;
}

.tab-btn {
  background-color: #333;
  border: none;
  color: white;
  padding: 8px 15px;
  cursor: pointer;
  border-radius: 5px;
  margin-right: 5px;
  transition: background-color 0.3s;
}

.tab-btn.active {
  background-color: #4287f5;
}

.tab-btn:hover {
  background-color: #444;
}

.tab-content {
  position: relative;
  height: 200px;
}

.slider.round:before {
  border-radius: 50%;
}

        .arrow-right {
          color: #32FF00;
        }
        /* A√±adir al CSS existente */
@media (max-width: 768px) 

  .grid {
    grid-template-columns: 1fr;
  }

  .full-width {
    grid-column: span 1;
  }

  .card {
    padding: 12px;
  }
}

/* Asegurar que la base sea responsive */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 12px;
}
/* A√±adir al CSS */
.ejercicio-progreso {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

.ejercicio-nombre {
  flex: 1;
}

.ejercicio-barra {
  width: 100px;
  height: 8px;
  background-color: #333;
  border-radius: 4px;
  margin: 0 10px;
  overflow: hidden;
}

.barra-progreso {
  height: 100%;
  transition: width 0.5s ease;
}

.ejercicio-valor {
  width: 50px;
  text-align: right;
}
/* A√±adir al CSS */
.logros-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.logro {
  text-align: center;
  padding: 8px;
  border-radius: 8px;
  transition: transform 0.2s;
}

.logro-activo {
  background-color: rgba(50, 255, 0, 0.2);
  border: 1px solid #32FF00;
}

.logro-inactivo {
  background-color: rgba(255, 255, 255, 0.1);
  border: 1px solid #333;
  opacity: 0.6;
}

.logro:hover {
  transform: scale(1.05);
}

.logro-icono {
  font-size: 24px;
  margin-bottom: 4px;
}

.logro-nombre {
  font-size: 12px;
}

    </style>
</head>
<body>
<div class="container">
    <h1>Resumen de Entrenamiento</h1>

    <div class="grid">
        <!-- A√±adir secci√≥n de logros -->
        <div class="card full-width">
            <div class="card-title green-text">üèÜ Logros Desbloqueados</div>
            <div class="logros-grid">
                {% for logro in logros_desbloqueados %}
                <div class="logro {% if logro.desbloqueado %}logro-activo{% else %}logro-inactivo{% endif %}"
                     title="{{ logro.descripcion }}">
                    <div class="logro-icono">{{ logro.icono }}</div>
                    <div class="logro-nombre">{{ logro.nombre }}</div>
                </div>
                {% empty %}
                <div class="logro-mensaje">¬°Completa m√°s entrenamientos para desbloquear logros!</div>
                {% endfor %}
            </div>
        </div>

        <!-- Logros de Hoy -->
        <div class="card full-width">
            <div class="card-title green-text">1 Logros de Hoy</div>
            <div class="green-text">‚û° Lograste aumentar el peso en <span class="red-text">2 ejercicios hoy</span></div>
        </div>

        <!-- Nivel de Consistencia -->
        <div class="card">
            <div class="card-title green-text">‚ö™ Nivel de Consistencia</div>
            <div>{{ consistencia.semanas_consecutivas }} semanas completadas</div>
            <div class="consistency-circles">
                {% for dia in consistencia.historial %}
                <div class="{% if dia %}checkmark{% else %}circle-empty{% endif %}"></div>
                {% endfor %}
            </div>


        </div>
        <!-- A√±adir nueva secci√≥n -->
        <div class="card full-width">
            <div class="card-title blue-text">üìä Tendencias a Largo Plazo</div>
            <div class="tabs">
                <button class="tab-btn active" data-periodo="3m">3 meses</button>
                <button class="tab-btn" data-periodo="6m">6 meses</button>
                <button class="tab-btn" data-periodo="1y">1 a√±o</button>
            </div>
            <div class="tab-content">
                <canvas id="graficoTendencias" height="200"></canvas>
            </div>
        </div>


        <!-- Carga Total -->
        <div class="card">
            <div class="card-title green-text">‚Üó Carga Total</div>
            <div>Hoy fue <span class="green-text">{% if carga.diferencia >= 0 %}+{% endif %}{{ carga.diferencia }}‚ÄØkg </span></div>
            <div>sobre tu media semanal</div>
            {% if carga.diferencia > 2000 %}
            <div class="red-text" style="margin-top: 10px;">Te recomendamos descanso activo ma√±ana üßò</div>
            {% endif %}
        </div>

        <!-- Sugerencias Inteligentes -->

        <div class="card">
            <div class="card-title yellow-text">üîç Sugerencias Inteligentes</div>
            {% for recomendacion in recomendaciones_personalizadas %}
            <div class="recomendacion">
                <span class="recomendacion-icono">{{ recomendacion.icono }}</span>
                <span class="red-text">{{ recomendacion.mensaje }}</span>
            </div>
            {% empty %}
            <div>¬°Excelente trabajo! Sigue con tu rutina actual.</div>
            {% endfor %}
        </div>


        <!-- Mejora por Ejercicio -->
        <div class="card">
            <div class="card-title green-text">üìä Mejora por Ejercicio</div>
            <div style="display: flex; justify-content: space-between;">
                <div>Prensa</div>
                <div class="arrow-up">‚Üë 10%</div>
            </div>
            <div style="display: flex; justify-content: space-between;">
                <div>Peso muerto</div>
                <div class="arrow-down">‚Üì -5%</div>
            </div>
            <div style="display: flex; justify-content: space-between;">
                <div>Elevaciones laterales</div>
                <div class="arrow-right">‚Üó ‚Üí</div>
            </div>

        </div>
        <!-- A√±adir en la secci√≥n de Pr√≥ximo Entreno -->
        <div class="card">
            <div class="card-title green-text">‚Üª Pr√≥ximo Entreno Recomendado</div>
            <div>{{ proximo_entreno.rutina }} - {{ proximo_entreno.fecha|date:"l" }} a las {{ proximo_entreno.hora }}</div>
            <button class="btn">Agendar entreno</button>
            <div class="notificaciones-opciones">
                <label class="switch">
                    <input type="checkbox" id="notificaciones-toggle" {% if notificaciones_activas %}checked{% endif %}>
                    <span class="slider round"></span>
                </label>
                <span>Recordatorio 1h antes</span>
            </div>
        </div>

        <!-- Estado Emocional -->
        <div class="card">
            <div class="card-title yellow-text">üòä Estado Emocional</div>
            <div>Progreso emojano el semana:</div>
            <div>üòä (positivo)</div>
        </div>


        <!-- Pr√≥ximo Entreno -->
        <div class="card">
            <div class="card-title green-text">Opciones</div>
            <div></div>
            <button class="btn">Volver a Menu</button>
        </div>


    </div>
</div>

<script>
    const ctx = document.getElementById('graficoProgreso').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['04 May', '11 May', '18 May'],
        datasets: [{
          label: 'Volumen total',
          data: [3400, 3900, 4700],
          borderColor: '#32FF00',
          tension: 0.3,
          fill: false
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { 
          legend: { display: false } 
        },
        scales: { 
          y: { 
            beginAtZero: true,
            grid: {
              color: '#333'
            },
            ticks: {
              color: '#999'
            }
          },
          x: {
            grid: {
              color: '#333'
            },
            ticks: {
              color: '#999'
            }
          }
        }
      }
    });
	
	// A√±adir al JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Configurar gr√°fico de tendencias
    const ctxTendencias = document.getElementById('graficoTendencias').getContext('2d');
    let graficoTendencias = new Chart(ctxTendencias, {
        type: 'line',
        data: {
            labels: [], // Se llenar√° con fechas
            datasets: [{
                label: 'Volumen total',
                data: [], // Se llenar√° con datos
                borderColor: '#4287f5',
                tension: 0.3,
                fill: false
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
                legend: { display: false } 
            },
            scales: { 
                y: { 
                    beginAtZero: true,
                    grid: { color: '#333' },
                    ticks: { color: '#999' }
                },
                x: {
                    grid: { color: '#333' },
                    ticks: { color: '#999' }
                }
            }
        }
    });
    
    // Cargar datos iniciales (3 meses)
    cargarDatosTendencia('3m');
    
    // Configurar cambio de pesta√±as
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            cargarDatosTendencia(this.dataset.periodo);
        });
    });
    
    // Funci√≥n para cargar datos seg√∫n per√≠odo
    function cargarDatosTendencia(periodo) {
        fetch(`/api/tendencias/?periodo=${periodo}`)
            .then(response => response.json())
            .then(data => {
                actualizarGraficoTendencias(data.fechas, data.valores);
            });
    }
    
    // Funci√≥n para actualizar el gr√°fico
    function actualizarGraficoTendencias(fechas, valores) {
        graficoTendencias.data.labels = fechas;
        graficoTendencias.data.datasets[0].data = valores;
        graficoTendencias.update();
    }
});

</script>
</body>
</html>
